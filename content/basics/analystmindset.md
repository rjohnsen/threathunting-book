---
title: "Analyst Mindset"
date: 2024-07-14T12:47:36+02:00
draft: true
weight: 2
---

Until today, we have focused heavily on the technology we use in the SOC. We haven't talked much about the human perspective that actually works with the 
systems. Today we will focus on the analyst and highlight methods and tools for approaching the role of analyst.

What we are going to talk about today are tools that are a notch above the routines, processes and specialist systems the SOC has. Virtually all SOCs have written 
routines and process descriptions for how to carry out analysis. It can be a bit overwhelming to get into. You will get to know ours when you start the training in pairs 
later. But before you embark on these routines and processes, it will be useful to look at tools that make you better equipped to handle them.

I have taken as a basis my experience with being a mentor for new employees and with building up SOC departments. Over the years, I have guided many 
students and found many good questions about becoming and being an analyst and doing analysis. At the same time, I have taken as a basis the questions I myself 
had when I started as an analyst.

Based on the questions and answers I have found, I have formulated this definition of what an analyst is:

> Being an analyst is about finding out about situations in a structured way that can be repeated within itself and on later occasions and that gives plausible 
answers"

By "into oneself" I mean that one uses the same methodology to examine any exits one finds along the way.

To treat this, today we will look at thought patterns, models and other snacks. Let's open this ball with a quote from one of Sun Microsystems' founders:

> "Many times experts fail because they're experts in the past version of the world".

The quote tells us that we must be "furthest in the shoe", always be on the cutting edge as the world changes quickly. In many ways, it reflects our everyday life in 
an excellent way. What was true yesterday is not necessarily true today. For us analysts, we face a completely new day every day.

But where do we begin our journey? We start by looking a little at thinking.

## What is analytical thinking Slide 3

Thinking is something we all do, every day - all year round. But have you thought about ways we can think? Ways we think we call thought patterns. Psychology has dealt with this 
thinking and has uncovered a great many thought patterns, for example it has been found that:

| Thinking mode | Desciption |
| ------------- | ---------- |
| Sequential thinking | Which is thinking by putting things in logical order |
| Concretizing thinking | Where we take our starting point and interpret what we see, hear, feel and experience |
| Abstract thinking | This is the opposite of concrete thinking. We lift ourselves up a notch and think more about things | 
| Holistic thinking | We think about the totality of things | 
| Lateral thinking | Thinking outside the box - the free jazz version of thinking where we try to put things in context using perhaps not entirely logical associations | 
| Critical thinking | Analyzing and assessing information about a case with a view to forming a well-founded and correct opinion, often as a basis for action. |

There are, of course, many other ways of thinking too - and it's not like we're locked into one mindset at a time. No, things flow into each other. This is because the brain is a complex machine and the situations we encounter require thought patterns to be combined.

Being aware of which thought patterns exist and are used when, then one can become more aware of how one thinks, and correct both oneself and the course further on. This is a very important feature to have in your toolbox.

Why am I focusing on this right here at the beginning of the presentation? Yes - being an analyst means thinking. A LOT. When we think a lot, one must be conscious of how one thinks to avoid that the train of thought is contaminated with impressions that shape the outcome. It just so happens that humans find it easy to perceive elements in the train of thought so that this colors further progress. This can be

| What | Description |
| ---- | ----------- |
| Prejudice | We drag our own opinions into the train of thought |
| Noise from the outside world | We are shaped by those we associate with and what we sense from the outside world. Perhaps a "truth" has been established in the department, or that we bring misinformation into the train of thought |
| Insecurity | We don't always fully understand the concepts and this creates uncertainty that manifests itself. The analysis can become very vague and the foundations stand on shaky ground. |
| Oblique safety | We are so sure that what we are looking for is there that we end up blind |
| Day form | Perhaps we have slept badly, or are ill - this is the condition that affects thinking |

There is a lot that affects our thinking - yes, also the weather and family relationships. Being an analyst is precisely being aware of how one thinks since it is a tool we use a lot. If we develop an understanding of how we think, we can use thinking as a tool in itself because we have mastered correcting ourselves.

I expect that most of you have come across analytical thinking. After all, this is a pattern of thinking that defines us, and as I like to call it, a tool.

But let's throw a definition up in the air here:

> "Analytical thinking is when you observe, research and develop critical insights from data or other information. When you use analytical thinking you get knowledge, 
solutions or ideas related to a problem or topic."

Overall, there are several steps analytical thinking consists of:

* We identify a topic, problem or issue
* We break down the topic, issue or problem into even smaller, more manageable segments
* We obtain relevant information from reliable sources
* We assess cause, effect and connections
* We develop solutions or advance our understanding of the subject
* We test solutions or new ideas based on what we have learned
* We review which solutions worked or assess our new knowledge

Each of these points can be broken down into methods to deal with each one. Later on in the working relationship, you will see that we can map the internal procedures and routines we have into these steps.

This is an important gateway to understanding how and why SOC works the way we do.

## What is analytical thinking? Slide 4

If we look a little more closely at the steps in analytical thinking, we find a common denominator: verbs! Thinking itself is a verb... that too. So, this is something we do!

If we break down what I said on the previous slide, we can extract important verbs that we will take with us into the analysis work. We say:

> * To identify
> * To split up
> * To catch up
> * To consider
> * To develop solutions
> * To promote understanding
> * To test
> * To review
> * To consider

This is a breakdown of the thought pattern that is good to have in your toolbox as an overall methodology – an approach to analyzing if you like.

In fact, I want to wrap these verbs in another layer. Namely dissemination! We must also be able to communicate the outcome of this process to others.

## What is analytical thinking? Slide 5

Analytical thinking is important, but it does not stand alone – it must be supported by other thought models. For us at SOC, we also need to add other thought patterns into the work. Although we 
have an analytical way of thinking, we have to combine this with critical thinking.

We need to analyze and assess information about a case with a view to forming a well-founded and correct opinion in order to take the actions we must.

We can run an analysis from A to Z without deciding whether what we are doing is right and correct in a purely mechanical way. In terms of quality, this is not fortunate since we have not taken a position along the way. It could be that we have something undiscovered in the blind spot

Two skills in particular are central here: Argumentation and strategic source assessment.

| What | Definition |
| ---- | ---------- |
| Argumentation | By argument, we mean being able to take a position on a case based on rationally valid reasons for which you have evidence. This involves being able to assess the validity of claims, as well as thinking through and accommodating possible counter-arguments. |
| Strategic source assessment | Strategic source assessment is the ability to use information from various information channels to interpret their content. For example, when reading a text online, you should look for the type of publication you are dealing with, who the publisher is and when it was published. You have to ask yourself, do the sources have credibility and authority that allows us to trust what they say? |

However, many times we encounter situations where there are gaps in the data base. Unfortunately, we have to fill gaps with plausible theories. We have to be creative, we have to find connections that are not always obvious. We also need creative thinking - in the technical language this is called "Lateral thinking".

But what is it?

It so happens that in many cases we cannot read our way to the answer. Perhaps important information is missing. Lateral thinking is a way of solving problems using an indirect and creative approach via reasoning that is not immediately obvious. Perhaps we can say that sometimes we have to hypothesize and examine whether the traces can fit into this hypothesis – rather than let the evidence make the hypothesis.

That is, involving ideas that may not be achieved using only traditional step-by-step logic. So, A leads to B which leads to C.

Yes - this is thinking outside the box. Many have researched this. Among others JP Guilford, perhaps best known for the task where you have to draw four lines through a matrix of 9 dots 
without raising your hand.

However, one I would like to highlight is Edward de Bono who in 1967 looked at different thought patterns and how these are combined to solve tasks. As I do here today. One of the concepts he focused on and elaborated is "lateral" thinking.

I interpret it like this:

> "Creative thinking is the ability to come up with new and innovative ideas. Imagination plays a big role in this process. One of its greatest qualities is that it knows no boundaries. If we let it. Imagination is the search engine of your brain. You fill your brain with information from various sources. You then use your imagination to draw connections between the information. If you free the boundaries and let your imagination run wild, it's amazing what ideas emerge"

This sounds great - use your imagination! But it's not like we can put our brains on hold and allow ourselves to flow freely. We must be aware of slowing down our imagination so that it does not lead us astray. Feel free to call it "freedom under responsibility"

Here we have to backtrack and think back to critical thinking. The fantasy must be plausible - you must be able to argue for it. To illustrate these three types of thinking, I have prepared a task for you. It is based on classic tasks for "lateral" thinking. Although it is meant for "lateral" thinking, it forces us to combine the thought patterns we have seen today.

A little warning here:

The task illustrates that we don't always have concrete things to go by. This could just as easily be a log file!

## What is analytical thinking slide 6

Here I want you to use the thought models we have talked about to solve this task.

> It's almost midnight. It's quite a storm outside. There is a storm. A man sits inside. He is watching TV. The TV signals come and go. The man gets bored. He screws off the light and goes to bed. The man wakes up the following morning and reads in the newspaper: 40 men have died last night right outside his door.

What has happened and what is the man's occupation?

### Answer 

Lighthouse keeper. He has turned off the light in the lighthouse, which has caused a ship to go down.

### Important clues

| Clue | Comment |
| ---- | ------- |
| Midnight | Night – you use the light at night |
| Storm | Storm belongs to the sea |
| A man is sitting inside | Is he inside because it's night or stormy? |
| He is watching TV | Not really that interesting |
| The TV signals come and go | Alludes to the weather being reasonably bad |
| Turn off the light | Why is the light mentioned at all? |
| He is going to bed | Action that can tell us something about this being an action with cover |
| Reading in the newspaper | The newspaper brings news |
| Died | What happened |
| Outside the door | Why are so many dying outside his door? |
| Man | Male-dominated profession |

With this task, we leave the brain a little.

## Words of wisdom - Slide 7

Okay. It was a bit about the mental model. In itself, handling and dealing with thought patterns is a tool. We have talked a lot about ourselves, but thought patterns as tools can also reveal how an attacker thinks. Think about it! If we move a little further here, I have found some quotes that help us further with being an 
analyst on a daily basis:

> "Every contact leaves a trace

Dr. Edmond Locard (1877 – 1966) was a French criminologist, pioneer of forensic science who became known as the "Sherlock Holmes of France". He formulated the basic principle of forensic science: "Every contact leaves a trace". This became known as Locard's exchange principle.

If everything leaves traces, is there a connection to trace? Sir Arthur Conan Doyle thought so in one of his books:

> "So all life is a great chain, the nature of which is known whenever we are shown a link of it."

He was a British author and physician. He created the character Sherlock Holmes in 1887 for "A Study in Red", the first of four novels and fifty-six short stories about Sherlock Holmes and Dr. Watson.

The Sherlock Holmes stories are milestones in crime fiction. His books were actually used to shape modern police investigation. Give it some thought. The quote here spins on Locard's. There is a connection between everything. If we then have traces and connections to the traces, what can they tell us?

> "Res ipsa loquitur

Means "The matter speaks for itself". This is an important principle. We must let things tell their own story and not attribute to them values they do not have. This is 
particularly difficult as we are often presented with stories from customers and others who will naturally color our investigation. This quote is often used by defense lawyers and courts, but the interpretation can be somewhat different depending on the jurisdiction. But let's just say, let things tell their own story. Easily.

As you can see, these three quotes are linked together. But, we are missing something. Where do we find the tracks? Yes - it's data. Our task is to wade through 
large amounts of data to find clues. We must be prepared to dissect data, twist and turn it to find what we are looking for.

But what are we typically looking for?

## What we look for - slide 8

In the data we process, we find a lot of interesting things and we find many stories there. Three key concepts you should know something about are IOA, IOB and IOC.

### IOA 

* Stands for Indicator of Attack
* IOA can be described as indications that something is about to happen (precursor), or that is happening here and now.
* Circumstances that we cannot fully specify, but which point to an attack - think of it as a sign that something is going on
* IOA-based detection looks at an attacker's behavior, regardless of whether the attacker uses a known or unknown attack, to find unknown or evolving exploits and attacks. Because an attacker doesn't need malware to break into your system, an IoA-based solution is great for catching criminals before they get past your defenses.

It's about uncovering the attack before it's over, preferably already on the receiving end. IOA are thus events that can reveal an active attack before indicators of compromise (IOC) become visible.

For example:

* Sudden increase in traffic to a website
* Sudden many operations against a file server at an unexpected time.
* Web servers that suddenly talk to hosts on internal networks
* Internal hosts talking to other internal hosts that they have never communicated with before
* A laptop that behaves "strangely
* Port scanning inside the network deviation on this.
* Increased Powershell activity on hosts
* Increased traffic to online shares, such as Dropbox and Box, which the company may not use

IOA detection requires near real-time monitoring and can be advantageously combined with machine learning and IOB. As well as having a vigilant eye on what is going on in the logs preferably by looking at statistics in dashboards.

### IOB

* Stands for Indicator of Behavio
* This is the way a user, device, account or other behaves - and deviations from this
* Think behavioral patterns
* A term you will hear is "baselining". This means that we measure normal behaviour, e.g. in a network. We then measure normal behavior patterns and report deviation on this.
* A good example is the song "Arne går mot døra" by Bare Egil Band. Who dares to sing along? The song begins like this:

> "Arne walks towards the door. Thinking thoughts he has thought 1000 times before. Is dressed in black as usual. A pale, pale face with a matching moustache. A matching mustache."

Here we know a lot about Arne.

* What if Arne changes clothes? Oh, a deviation there.
* Or that he shaves off his moustache?
* What if he goes towards another place? Oops, another discrepancy. Perhaps this indicates that Arne is doing something he doesn't usually do? Maybe something dangerous, yes we are was on this and keeps him under surveillance.

If we draw parallels to Arne towards the logs, we find corresponding action patterns in the logs

* Some are permanent. It can be services that talk to fixed hosts, or users who use spotify or Teams.
* Some happen sporadically, but there is a large basis for normal traffic
* Some patterns may only happen once - e.g. An admin tests a concept/runs a network scan or something else.
* Some patterns may only happen 1 time – massive dump of data from network share

What is important is that we have an overview of the more or less fixed behavior patterns - that we have a baseline to work from. Because then we can "easier" find deviation

However, deviations can be completely normal

> Example: Kjell Bjarne is a stressed salesman and one day we get an alarm that he has uploaded X number of GB to Dropbox.

If we had mapped a baseline, we could have seen whether this was normal for Kjell Bjarne or not

* Does it happen regularly or sporadically?
* Perhaps this is part of a normal workflow

We can ask the "customer" about this and perhaps find a smart way to find out what he is uploading? There may be sensitive data there, there are solutions to detect that. Ex. PII and Visa numbers.

* By mapping IOBs, we can calculate a threat score on whether the object
* Runs a major safety risk based on his behaviour.

### IOC

* • Stands for Indicator of Compromise
* • So indications of compromise - that something has happened
* • Think about what traces criminals leave behind at the crime scene and that we pick these up afterwards
* • It is important to stress that these are indications that must be investigated

In our world, the IOC can be

* Header
* IP
* Techniques
* Network artefacts
* Tools
* Domain names
* Registry keys
* Mysterious behavior / deviation from normal that is visible
* Among other things

We work a lot with IOCs - it's a big part of our everyday life.

* We obtain IOCs from many sources - from external vulnerability registers, e-mail lists and other.
* You have probably seen news reports about attacks. These often contain IOCs on which we can base an investigation.
* We also find these on our own by analyzing alarms and network traffic
* Maybe OpenCTI rings a bell? Alan had a video about this a while ago
* But, remember that the IOC deals with things that have already happened based on "things" you yourself or others have found

## In short 

| Type | Comment |
| ---- | ------- |
| IOA  | Deals with indications that something is happening |
| IOB  | Deals with behavioral patterns and deviations | 
| IOC  | Deals with more or less "tangible" things attackers leave behind |

It can be a bit difficult to grasp these terms. What exactly is the difference between IOA and IOB? And what about the IOC? I will try to explain this here.

We can extract IOCs from IOA. Perhaps there is a common denominator that we can base ourselves on? Back to the example of a sudden increase in traffic to a website:

* We can treat the IP where the traffic came from as IOC
* The IP contains ASN information
* Or Geolocation for IP
* We can look at what the traffic consists of
* We can check if others have found something strange with this IP

We can consider IOA as a situation. If we combine that with historical behavior patterns (IOB), we can determine whether this is something that happens often or rarely. Maybe it's a familiar pattern that no one recognized just now?

With these three concepts in combination, we have now done a thorough job with the analysis because we have built context! IOA helped to uncover that something is happening, IOC gives us some pegs we can watch out for, IOB supports whether this is something that tends to happen.

I'm not going to completely let go of the IOC just yet because it's so important. This is what we encounter most often. We therefore need to talk about how we treat IOCs and the consequences of our actions.

Newton said something clever in his 3rd law:

> "For every action there is an equal and opposite reaction."

And we have to keep that in mind now.

## The analyst mindset slide 14

Through this presentation, we have given a proposal for methodology and tools to handle detection. Unfortunately, it is probably not absolute, it must be adapted to use and situation. Even we must be adaptable. But it is a good starting point to take us a step further and as a tool to use the processes and routines the SOC has. If we take a step to the left and look at the whole here, we have given an insight into what is meant by being an analyst, as well as some of the thinking behind it.

The psychology and methodology behind the analyst's mindset is large and complex - and not least interesting. We have therefore tried to find models that fit Defendable's spirit and turn these into practice. If we lump all the concepts we have talked about today together, we will be better prepared to handle analysis than we were before we came here in day.

As Skinner points out in the quote here:

> Being wrong isn't always wrong - it might be the best thing we could do given the situation.

It may actually be appropriate to fail and redo the processes. This is perhaps the greatest strength of OODA – it allows us to start over with newly acquired information.


















